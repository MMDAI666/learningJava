# 操作系统相关面试题

## 进程和线程

- 根本区别：进程是操作系统资源分配的基本单位，而线程是处理器任务调度和执行的基本单位

- 资源开销：每个进程都有独立的代码和数据空间（程序上下文），程序之间的切换会有较大的开销；线程可以看做轻量级的进程，同一类线程共享代码和数据空间，每个线程都有自己独立的运行栈和程序计数器（PC），线程之间切换的开销小。

- 包含关系：如果一个进程内有多个线程，则执行过程不是一条线的，而是多条线（线程）共同完成的；线程是进程的一部分，所以线程也被称为轻权进程或者轻量级进程。

- 内存分配：同一进程的线程共享本进程的地址空间和资源，而进程之间的地址空间和资源是相互独立的

- 影响关系：一个进程崩溃后，在保护模式下不会对其他进程产生影响，但是一个线程崩溃整个进程都死掉。所以多进程要比多线程健壮。

- 执行过程：每个独立的进程有程序运行的入口、顺序执行序列和程序出口。但是线程不能独立执行，必须依存在应用程序中，由应用程序提供多个线程执行控制，两者均可并发执行

## 线程之间同步的方式

线程同步指的是线程之间“协同”，即线程之间按照规定的先后次序运行。
线程同步主要包括四种方式：

1. 互斥量 pthread_mutex_
2. 读写锁 pthread_rwlock_
3. 条件变量 pthread_cond_
4. 信号量 sem_  

## 信号量semaphore的原理

信号量分为有名信号量和无名信号量，无名信号量用于线程同步，有名信号量一般用于进程之间管理。
信号量本质上是一个非负的整数计数器，用于控制公共资源的访问，也被称为PV原子操作：

P操作：即信号量sem减一，若sem小于等于0则P操作被阻塞，直到sem变量大于0为止
V操作：即信号量sem加一  
java中Semaphore采用了CAS来实现，尽量避免锁的使用，提高了性能  

## 逻辑内存（虚拟内存）和物理内存

### 什么是虚拟内存

虚拟内存能够创建一个连续更大的空间给进程使用，出现的原因是由于主存的空间是有限，当运行多个进程或者一个进程需要更大的空间进行存储运行，主存显然是不够的，这个时候就需要更大更便宜的磁盘进行保存一部分数据  
对于进程来说，虚拟内存就是一张连续的内存空间，这个空间有些在主存中，有些在磁盘中。  

### 虚拟内存作用

1. 安全隔离，进程访问自身的私有内存片
2. 共享内存，在进程之间有效共享代码库
3. 善用碎片空间，更有效率地使用主存能够创建给主存更多的空间，每个进程都独有一个虚拟内存，并且解决主存非连续空间分配内存给某进程善用碎片空间  

### 虚拟内存会给运行时程序带来什么影响?//todo

## 死锁 //todo

## 多路复用 //todo